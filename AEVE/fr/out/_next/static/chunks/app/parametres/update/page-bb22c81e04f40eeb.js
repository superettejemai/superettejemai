(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[163],{11525:(e,r,s)=>{Promise.resolve().then(s.bind(s,43614))},43614:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>o});var t=s(95155),a=s(12115);let o=()=>{let[e,r]=(0,a.useState)(null),[s,o]=(0,a.useState)({name:"",email:"",phone:"",currentPassword:"",newPassword:"",confirmPassword:""}),[n,l]=(0,a.useState)(!1),[i,d]=(0,a.useState)(""),[c,m]=(0,a.useState)("profile");(0,a.useEffect)(()=>{x()},[]);let x=async()=>{try{let e=localStorage.getItem("authToken"),s=await fetch("http://localhost:4000/api/users/me",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(s.ok){let e=await s.json();r(e.user),o(r=>({...r,name:e.user.name,email:e.user.email||"",phone:e.user.phone||""}))}else throw Error("Failed to fetch user data")}catch(e){console.error("Error fetching user data:",e),d("Error loading user data")}},u=e=>{let{name:r,value:s}=e.target;o(e=>({...e,[r]:s}))},p=async e=>{e.preventDefault(),l(!0),d("");try{let e=localStorage.getItem("authToken"),t={name:s.name,email:s.email,phone:s.phone},a=await fetch("http://localhost:4000/api/users/me",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(t)});if(a.ok){let e=await a.json();r(e.user),d("Profile updated successfully!")}else{let e=await a.json();d(`Error: ${e.message}`)}}catch(e){d("Error updating profile"),console.error("Error updating profile:",e)}finally{l(!1)}},g=async e=>{if(e.preventDefault(),l(!0),d(""),s.newPassword!==s.confirmPassword){d("New passwords do not match"),l(!1);return}try{let e=localStorage.getItem("authToken"),r={currentPassword:s.currentPassword,newPassword:s.newPassword},t=await fetch("http://localhost:4000/api/users/me",{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(t.ok)d("Password updated successfully!"),o(e=>({...e,currentPassword:"",newPassword:"",confirmPassword:""}));else{let e=await t.json();d(`Error: ${e.message}`)}}catch(e){d("Error updating password"),console.error("Error updating password:",e)}finally{l(!1)}},[h,y]=(0,a.useState)(!1),[b,w]=(0,a.useState)(!1),[f,j]=(0,a.useState)(!1);return e?(0,t.jsxs)("div",{className:"max-w-2xl mx-auto my-10",children:[(0,t.jsx)("div",{className:"border-b border-gray-200 mb-6",children:(0,t.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,t.jsx)("button",{onClick:()=>m("profile"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"profile"===c?"border-gray-600 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Personal Information"}),(0,t.jsx)("button",{onClick:()=>m("password"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"password"===c?"border-gray-600 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Password Management"})]})}),i&&(0,t.jsx)("div",{className:`p-4 rounded-md mb-6 ${i.includes("Error")?"bg-red-100 text-red-700 border border-red-200":"bg-green-100 text-green-700 border border-green-200"}`,children:i}),"profile"===c&&(0,t.jsxs)("div",{className:"border border-gray-200 p-6 bg-white",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Personal Information"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage your personal details."}),(0,t.jsxs)("form",{onSubmit:p,className:"mt-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,t.jsx)("input",{type:"text",name:"name",value:s.name,onChange:u,className:"mt-1 block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email Address"}),(0,t.jsx)("input",{type:"email",name:"email",value:s.email,onChange:u,className:"mt-1 block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),(0,t.jsx)("input",{type:"text",name:"phone",value:s.phone,onChange:u,className:"mt-1 block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),(0,t.jsxs)("div",{className:"relative w-full inline-block",children:[(0,t.jsxs)("select",{value:e.role,disabled:!0,className:"appearance-none border border-gray-300 text-gray-700 bg-gray-100 px-4 py-4 pr-10 text-sm w-full cursor-not-allowed",children:[(0,t.jsx)("option",{children:"Admin"}),(0,t.jsx)("option",{children:"Worker"})]}),(0,t.jsx)("svg",{className:"w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Role cannot be changed"})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:n,className:"bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium px-5 py-4 disabled:opacity-50",children:n?"Saving...":"Save Changes"})})]})]}),"password"===c&&(0,t.jsxs)("div",{className:"border border-gray-200 p-6 bg-white",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Password Management"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Update your account password."}),(0,t.jsxs)("form",{onSubmit:g,className:"mt-6 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,t.jsxs)("div",{className:"relative mt-1",children:[(0,t.jsx)("input",{type:h?"text":"password",name:"currentPassword",value:s.currentPassword,onChange:u,required:!0,className:"block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none pr-10"}),(0,t.jsx)("button",{type:"button",onClick:()=>y(!h),className:"absolute inset-y-0 right-3 flex items-center text-gray-400 hover:text-gray-600",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,t.jsxs)("div",{className:"relative mt-1",children:[(0,t.jsx)("input",{type:b?"text":"password",name:"newPassword",value:s.newPassword,onChange:u,required:!0,className:"block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none pr-10"}),(0,t.jsx)("button",{type:"button",onClick:()=>w(!b),className:"absolute inset-y-0 right-3 flex items-center text-gray-400 hover:text-gray-600",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,t.jsxs)("div",{className:"relative mt-1",children:[(0,t.jsx)("input",{type:f?"text":"password",name:"confirmPassword",value:s.confirmPassword,onChange:u,required:!0,className:"block w-full border border-gray-300 px-3 py-4 text-sm text-gray-800 focus:ring-1 focus:ring-gray-500 focus:border-gray-500 outline-none pr-10"}),(0,t.jsx)("button",{type:"button",onClick:()=>j(!f),className:"absolute inset-y-0 right-3 flex items-center text-gray-400 hover:text-gray-600",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",children:[(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-4",children:(0,t.jsx)("button",{type:"submit",disabled:n,className:"bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium px-5 py-4 disabled:opacity-50",children:n?"Updating...":"Update Password"})})]})]})]}):(0,t.jsx)("div",{className:"max-w-2xl mx-auto my-10 p-6",children:(0,t.jsx)("div",{className:"animate-pulse",children:"Loading user data..."})})}}},e=>{e.O(0,[441,794,358],()=>e(e.s=11525)),_N_E=e.O()}]);