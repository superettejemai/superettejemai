(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[513],{13220:(e,t,s)=>{"use strict";s.d(t,{k5:()=>d});var r=s(12115),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},l=r.createContext&&r.createContext(a),n=["attr","size","title"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e}).apply(this,arguments)}function c(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function o(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?c(Object(s),!0).forEach(function(t){var r,a,l;r=e,a=t,l=s[t],(a=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(a))in r?Object.defineProperty(r,a,{value:l,enumerable:!0,configurable:!0,writable:!0}):r[a]=l}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function d(e){return t=>r.createElement(u,i({attr:o({},e.attr)},t),function e(t){return t&&t.map((t,s)=>r.createElement(t.tag,o({key:s},t.attr),e(t.child)))}(e.child))}function u(e){var t=t=>{var s,{attr:a,size:l,title:c}=e,d=function(e,t){if(null==e)return{};var s,r,a=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)s=l[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(a[s]=e[s])}return a}(e,n),u=l||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),r.createElement("svg",i({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,d,{className:s,style:o(o({color:e.color||t.color},t.style),e.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),c&&r.createElement("title",null,c),e.children)};return void 0!==l?r.createElement(l.Consumer,null,e=>t(e)):t(a)}},63618:(e,t,s)=>{Promise.resolve().then(s.bind(s,80498))},73321:(e,t,s)=>{"use strict";var r=s(74645);s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},80498:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(95155),a=s(12115),l=s(36959),n=s(73321);let i=[{key:"users",label:"Utilisateurs",dependencies:["orders","factures"]},{key:"products",label:"Produits",dependencies:["product_images","order_items","facture_items"]},{key:"orders",label:"Commandes",dependencies:["order_items"]},{key:"factures",label:"Factures",dependencies:["facture_items"]},{key:"templates",label:"Templates",dependencies:[]},{key:"audit_logs",label:"Logs d'audit",dependencies:[]}];function c(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(!1),[c,o]=(0,a.useState)(!1),[d,u]=(0,a.useState)(!1),[m,p]=(0,a.useState)([]),[h,f]=(0,a.useState)(i),[x,b]=(0,a.useState)(!1);(0,a.useEffect)(()=>{f(i)},[]);let y=e=>{p(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])},j=async()=>{if(!m.length)return alert("S\xe9lectionnez au moins une table !");try{let e=await fetch("http://localhost:4000/api/backup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:m})});if(!e.ok)throw Error("Erreur lors de la sauvegarde");let t=await e.json(),r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),l=document.createElement("a");l.href=a,l.download="backup.json",l.click(),s(!1)}catch(e){console.error(e),alert("Erreur lors de la sauvegarde !")}},g=async e=>{let t=e.target.files?.[0];if(t)try{let e=await t.text(),s=JSON.parse(e);if(!(await fetch("http://localhost:4000/api/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:s})})).ok)throw Error("Erreur lors de la restauration");alert("Restauration termin\xe9e !"),o(!1)}catch(e){console.error(e),alert("Erreur lors de la restauration !")}},v=async()=>{if(!m.length)return alert("S\xe9lectionnez au moins une table !");try{if(!(await fetch("http://localhost:4000/api/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tables:m})})).ok)throw Error("Erreur lors de la suppression");alert("Suppression termin\xe9e !"),u(!1),p([])}catch(e){console.error(e),alert("Erreur lors de la suppression !")}},N=async()=>{let e=document.createElement("input");e.type="file",e.accept=".db",e.onchange=async e=>{let t=e.target.files?.[0];if(t){if(!t.name.endsWith(".db"))return void alert("Veuillez s\xe9lectionner un fichier de base de donn\xe9es (.db)");b(!0);try{let e=new FormData;e.append("database",t);let s=await fetch("https://superettejemai.onrender.com/api/change-db",{method:"POST",body:e});if(!s.ok)throw Error("Erreur lors de l'upload de la base de donn\xe9es");let r=await s.json();alert("Base de donn\xe9es mise \xe0 jour avec succ\xe8s !"),console.log("Upload result:",r)}catch(e){console.error(e),alert("Erreur lors de l'upload de la base de donn\xe9es !")}finally{b(!1)}}},e.click()};return(0,r.jsx)("div",{className:"min-h-full max-w-full mx-auto",children:(0,r.jsxs)("div",{className:"min-h-full bg-white p-6 text-gray-900",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10 max-w-full mx-auto",children:[(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Template Recu"}),(0,r.jsxs)("button",{onClick:()=>e.push("/parametres/template"),className:"w-full flex items-center justify-center bg-gray-600 text-white py-4 font-medium hover:bg-gray-700 transition space-x-2",children:[(0,r.jsx)(l.C5Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Modifier format re\xe7u"})]})]}),(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Profile"}),(0,r.jsxs)("button",{onClick:()=>e.push("/parametres/update"),className:"w-full flex items-center justify-center bg-gray-600 text-white py-4 font-medium hover:bg-gray-700 transition space-x-2",children:[(0,r.jsx)(l.ILG,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Modifier le profile"})]})]}),(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsx)("h3",{className:"font-bold text-lg mb-3",children:"Espace Utilisateur"}),(0,r.jsxs)("button",{onClick:()=>e.push("/parametres/users"),className:"w-full flex items-center justify-center bg-gray-600 text-white py-4 font-medium hover:bg-gray-700 transition space-x-2",children:[(0,r.jsx)(l.jh0,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Management des utilisateurs"})]})]})]}),(0,r.jsx)("div",{className:"space-y-8",children:(0,r.jsxs)("div",{className:"bg-gray-50 p-5",children:[(0,r.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Contr\xf4les de la base de donn\xe9es"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("button",{className:"w-full flex items-center justify-center border border-gray-300 py-4 px-3 hover:bg-gray-100 transition space-x-2",onClick:()=>s(!0),children:[(0,r.jsx)(l.fIi,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Sauvegarder la base de donn\xe9es locale"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center border border-gray-300 py-4 px-3 hover:bg-gray-100 transition space-x-2",onClick:()=>o(!0),children:[(0,r.jsx)(l.IY_,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Restaurer la base de donn\xe9es locale"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center border border-gray-300 py-4 px-3 hover:bg-gray-100 transition space-x-2",onClick:()=>u(!0),children:[(0,r.jsx)(l.IY_,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Supprimer des tables locales"})]}),(0,r.jsxs)("button",{className:"w-full flex items-center justify-center border border-gray-300 py-4 px-3 hover:bg-gray-100 transition space-x-2 disabled:opacity-50",onClick:N,disabled:x,children:[(0,r.jsx)(l.Kh2,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:x?"Upload en cours...":"Mettre \xe0 jour la base de donn\xe9es distante"})]})]}),(0,r.jsxs)("div",{className:"mt-6",children:[(0,r.jsx)("h3",{className:"font-bold mb-2",children:"Langue"}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(l.Ifv,{className:"w-4 h-4"}),(0,r.jsx)("select",{className:"border border-gray-300 py-4 px-3 w-full text-sm focus:outline-none",children:(0,r.jsx)("option",{children:"Fran\xe7ais"})})]})]})]})})]}),t&&(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 w-full max-w-2xl",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Confirmer la sauvegarde"}),(0,r.jsx)("p",{className:"mb-3 text-base text-gray-700",children:"S\xe9lectionnez les tables \xe0 sauvegarder. Les d\xe9pendances seront incluses automatiquement."}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-4 mb-4",children:h.map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-4",children:[(0,r.jsx)("input",{type:"checkbox",className:"w-8 h-8",checked:m.includes(e.key),onChange:()=>y(e.key)}),(0,r.jsx)("span",{className:"text-lg",children:e.label})]},e.key))}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"px-6 py-4 bg-gray-300",onClick:()=>s(!1),children:"Annuler"}),(0,r.jsx)("button",{className:"px-6 py-4 bg-green-700 text-white",onClick:j,children:"Sauvegarder"})]})]})}),c&&(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/50 z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 w-full max-w-md",children:[(0,r.jsx)("h2",{className:"text-lg font-bold mb-4",children:"Confirmer la restauration"}),(0,r.jsx)("p",{className:"mb-3 text-sm text-red-600 font-medium",children:"⚠️ Attention : Cette op\xe9ration peut \xe9craser des donn\xe9es existantes."}),(0,r.jsx)("input",{type:"file",className:"border p-2 w-full mb-4",accept:".json",onChange:g}),(0,r.jsx)("div",{className:"flex justify-end gap-2",children:(0,r.jsx)("button",{className:"px-4 py-4 bg-gray-300",onClick:()=>o(!1),children:"Annuler"})})]})}),d&&(0,r.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-black/60 z-50",children:(0,r.jsxs)("div",{className:"bg-white p-6 w-full max-w-lg",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4 text-red-600",children:"Confirmer la suppression"}),(0,r.jsx)("p",{className:"mb-3 text-base text-red-600 font-medium",children:"⚠️ Attention : Cette op\xe9ration supprimera d\xe9finitivement les donn\xe9es s\xe9lectionn\xe9es !"}),(0,r.jsx)("div",{className:"max-h-60 overflow-y-auto space-y-6 mb-4",children:h.filter(e=>"orders"!==e.key&&"factures"!==e.key).map(e=>(0,r.jsxs)("label",{className:"flex items-center gap-4",children:[(0,r.jsx)("input",{type:"checkbox",className:"w-8 h-8",checked:m.includes(e.key),onChange:()=>y(e.key)}),(0,r.jsx)("span",{className:"text-lg",children:e.label})]},e.key))}),(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{className:"px-6 py-4 bg-gray-300",onClick:()=>u(!1),children:"Annuler"}),(0,r.jsx)("button",{className:"px-6 py-4 bg-red-600 text-white",onClick:v,children:"Supprimer"})]})]})})]})})}}},e=>{e.O(0,[87,441,794,358],()=>e(e.s=63618)),_N_E=e.O()}]);